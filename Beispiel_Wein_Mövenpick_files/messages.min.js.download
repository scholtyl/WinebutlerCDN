define(['jquery','uiComponent','Magento_Customer/js/customer-data','underscore','escaper','jquery/jquery-storageapi'],function($,Component,customerData,_,escaper){'use strict';return Component.extend({defaults:{cookieMessages:[],cookieMessagesObservable:[],messages:[],allowedTags:['div','span','b','strong','i','em','u','a']},initialize:function(){this._super().observe(['cookieMessagesObservable']);this.cookieMessages=_.unique($.cookieStorage.get('mage-messages'),'text');this.cookieMessagesObservable(this.cookieMessages);this.messages=customerData.get('messages').extend({disposableCustomerData:'messages'});$.mage.cookies.set('mage-messages','',{samesite:'strict',domain:''});},prepareMessageForHtml:function(message){return escaper.escapeHtml(message,this.allowedTags);},purgeMessages:function(){if(!_.isEmpty(this.messages().messages)){customerData.set('messages',{});}}});});