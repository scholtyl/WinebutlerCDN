define(['uiComponent','jquery','ko','Creativestyle_CustomizationMovenpickSubsidiary/js/model/currentProduct','mage/url','mage/translate','Magento_Ui/js/modal/modal',],function(Component,$,ko,currentProduct,urlBuilder,$t){'use strict';return Component.extend({loaded:false,sku:{},cache:[],initialize:function(){let result=this._super();let self=this;var modal=$(this.popupSectionSelector).modal({type:'popup',title:$t('Availability in stores'),trigger:'[data-trigger=availability-popup]',responsive:false,buttons:[],modalClass:'cs-buybox__availability-in-stores-modal',opened:function(){if(!self.loaded){self.loadItems();}}});return result;},loadItems:async function(){if(this.cache[currentProduct.sku()]!==undefined){return this.cache[currentProduct.sku()];}
const availabilityProductsEndpoint=urlBuilder.build('subsidiary/product/availability');const data=currentProduct.sku()?{'sku':currentProduct.sku()}:{'sku':this.sku};const response=await $.ajax({url:availabilityProductsEndpoint,data:data});const{content}=response;if(!content||content===''){return;}
let popupSectionSelector=this.contentSelector??'productAvailabilityContent';let element=document.querySelector(`${popupSectionSelector}`);element.innerHTML=content;this.cache[currentProduct.sku()]=content;}});});